---
import BlueNoteLayout from '../layouts/BlueNoteLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects.filter(project => project.data.featured).sort((a, b) => a.data.sortOrder - b.data.sortOrder);
const otherProjects = allProjects.filter(project => !project.data.featured).sort((a, b) => a.data.sortOrder - b.data.sortOrder);
---

<BlueNoteLayout title="Our Work">
  <main class="container mx-auto px-4 py-8 text-white">
    <h1 class="text-4xl font-bold mb-8">Our Work</h1>

    <section class="mb-12">
      <h2 class="text-3xl font-semibold mb-6">Featured Projects</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {featuredProjects.map(project => (
          <a href={`/work/${project.slug}`} class="block bg-gray-800 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
            {project.data.coverImage && <Image src={project.data.coverImage} alt={project.data.title} class="w-full h-48 object-cover rounded-t-lg" widths={[300, 600, 900]} sizes="(max-width: 768px) 100vw, 33vw"/>}
            <div class="p-4">
              <h3 class="text-xl font-bold mb-2">{project.data.title}</h3>
              <p class="text-zinc-400">{project.data.description}</p>
            </div>
          </a>
        ))}
      </div>
    </section>

    <section>
      <h2 class="text-3xl font-semibold mb-6">Other Projects</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {otherProjects.map(project => (
          <a href={`/work/${project.slug}`} class="block bg-gray-800 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
            {project.data.coverImage && <Image src={project.data.coverImage} alt={project.data.title} class="w-full h-48 object-cover rounded-t-lg" widths={[300, 600, 900]} sizes="(max-width: 768px) 100vw, 33vw"/>}
            <div class="p-4">
              <h3 class="text-xl font-bold mb-2">{project.data.title}</h3>
              <p class="text-zinc-400">{project.data.description}</p>
            </div>
          </a>
        ))}
      </div>
    </section>
  </main>
</BlueNoteLayout>
