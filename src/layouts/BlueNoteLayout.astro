---
import Sidebar from '../components/layout/Sidebar.astro';
import MobileNav from '../components/layout/MobileNav.svelte';
import Marquee from '../components/ui/Marquee.svelte';
import PersistentPlayer from '../components/media/PersistentPlayer.svelte';
import Footer from '../components/layout/Footer.astro';
import { ClientRouter } from 'astro:transitions';
import '../styles/global.css';

interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="dark antialiased">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} | Nathan Sounds</title>
    
    <!-- FONTS: Inter for structure, Lora for soul, JetBrains for the tech details -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400&family=Lora:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
    
    <ClientRouter />
  </head>
  
  <body class="flex flex-col h-screen overflow-hidden bg-[var(--color-bg-main)] text-[var(--color-ink-primary)] selection:bg-yellow-500/30 selection:text-yellow-200">
    
    <!-- GLOBAL TEXTURE: The "Vinyl" Grain Overlay -->
    <div class="vinyl-grain"></div>

    <!-- ANNOUNCEMENT BAR -->
    <div class="z-50 relative">
      <Marquee client:load />
    </div>

    <div class="flex flex-1 overflow-hidden w-full relative z-10">
      
      <!-- FIXED SIDEBAR (Left) -->
      <!-- 'glass-panel' utility provides the metallic border and blur -->
      <aside class="w-72 flex-shrink-0 hidden md:block h-full glass-panel">
        <Sidebar />
      </aside>

      <!-- SCROLLABLE CONTENT (Center) -->
      <!-- Added a subtle gradient at the very top of the content area for depth -->
      <main class="flex-1 overflow-y-auto scroll-smooth relative no-scrollbar">
        
        <!-- Mobile Nav appears here on small screens -->
        <div class="md:hidden sticky top-0 z-40 bg-[var(--color-bg-main)]/80 backdrop-blur-md border-b border-[var(--color-border)]">
           <MobileNav client:load />
        </div>

        <div class="max-w-4xl mx-auto px-6 py-12 md:py-24 min-h-screen">
          <slot /> <!-- Content injects here -->
          
          <div class="mt-20 pt-10 border-t border-[var(--color-border)]">
             <Footer />
          </div>
        </div>
      </main>
    </div>

    <!-- PERSISTENT PLAYER -->
    <!-- Wrapped in a 'persist' block so the music doesn't stop when navigating -->
    <div transition:persist class="relative z-50">
      <PersistentPlayer client:load />
    </div>

  </body>
</html>